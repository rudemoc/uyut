{% extends "base.html" %}
{% block content %}
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<div id="main">
    <script type="application/json" id="room-messages-data">
        {{ messages | tojson | safe }}
    </script>
    <div id="room-data" 
         data-default-avatar="{{ default_avatar }}"
         data-user-id="{{ user.id }}"
         data-user-name="{{ user.display_name }}"
         data-user-avatar="{{ user.avatar }}"
         style="display: none;">
    </div>
    
    <div id="header">
        <h1>{{ title }} <small style="color: #8899a6;">({{ room }})</small></h1>
        <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 5px;">
            <img src="data:image/png;base64,{{ user.avatar }}" class="avatar" style="width: 24px; height: 24px;">
            <span style="color: #8899a6; font-size: 0.9em;">{{ user.display_name }}</span>
            <a href="{{ url_for('profile') }}" style="color: #19cf86; font-size: 0.8em; margin-left: 10px;">ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</a>
            <a href="{{ url_for('home') }}" style="color: #19cf86; font-size: 0.8em; margin-left: 10px;">Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ</a>
        </div>
    </div>
    
    <div id="messages"></div>
    
    <form id="send-container" enctype="multipart/form-data">
        <div class="editor-toolbar">
            <button type="button" id="bold-btn"><strong>B</strong></button>
            <button type="button" id="italic-btn"><em>I</em></button>
            <select id="size-select">
                <option value="">Size</option>
                <option value="1">Small</option>
                <option value="3">Normal</option>
                <option value="5">Large</option>
                <option value="7">Huge</option>
            </select>
            <button type="button" id="emoji-btn">ğŸ˜Š</button>
            <div id="emoji-picker" class="emoji-picker hidden">
                <div class="emoji-picker-header">
                    <span>Pick Emojis</span>
                    <button type="button" id="close-emoji-picker" class="close-emoji">âœ•</button>
                </div>
                <div class="emoji-grid">
                    <button class="emoji">ğŸ˜€</button>
                    <button class="emoji">ğŸ˜‚</button>
                    <button class="emoji">ğŸ˜</button>
                    <button class="emoji">â¤ï¸</button>
                    <button class="emoji">ğŸ‘</button>
                    <button class="emoji">ğŸ‘</button>
                    <button class="emoji">ğŸ”¥</button>
                    <button class="emoji">ğŸ‰</button>
                    <button class="emoji">ğŸ¤”</button>
                    <button class="emoji">ğŸ˜¢</button>
                    <button class="emoji">ğŸ˜¡</button>
                    <button class="emoji">ğŸ¥³</button>
                    <button class="emoji">ğŸš€</button>
                    <button class="emoji">ğŸŒŸ</button>
                    <button class="emoji">ğŸ•</button>
                    <button class="emoji">ğŸ¶</button>
                    <button class="emoji">ğŸ±</button>
                    <button class="emoji">ğŸŒˆ</button>
                    <button class="emoji">âš¡</button>
                    <button class="emoji">ğŸ“¸</button>
                </div>
            </div>
            <input type="file" id="file-input" name="file" multiple
                accept="image/*,video/*,audio/*,.gif,.zip,.pdf,.txt,.doc,.docx,.xlsx,.ppt,.pptx">
        </div>
        <div class="resizer-top"></div>
        <div id="message-editor" contenteditable="true" data-placeholder="What's happening?"></div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 8px;">
            <span id="char-counter" style="color: #8899a6; font-size: 0.8em;">0/512</span>
            <button type="submit" id="send-button">Post</button>
        </div>
    </form>
    
    <div id="image-viewer" class="image-viewer hidden">
        <div class="image-viewer-content">
            <img id="viewer-image" src="" alt="Full-size image">
            <button id="close-viewer" class="close-button">âœ•</button>
        </div>
    </div>
    
    <div id="cooldown-overlay" class="cooldown-overlay hidden">
        <div class="cooldown-timer">
            <span id="cooldown-seconds">1</span> second until you can post again
            <div class="cooldown-progress"></div>
        </div>
    </div>
</div>

<style>
#char-counter {
    padding: 0 10px;
}

.message .avatar {
    cursor: pointer;
    transition: opacity 0.2s ease;
}

.message .avatar:hover {
    opacity: 0.8;
}
</style>
{% endblock %}