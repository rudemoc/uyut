{% extends "base.html" %}
{% block content %}
<div class="home-container">
    <!-- –•–µ–¥–µ—Ä —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π -->
    <div class="home-header">
        <div class="header-content">
            
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="home-main">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="left-column">
            <div class="user-card">
                <img src="data:image/png;base64,{{ user.avatar }}" class="user-avatar" alt="–ê–≤–∞—Ç–∞—Ä">
                <div class="user-info">
                    <h3>{{ user.display_name }}</h3>
                    <p>@{{ user.username }}</p>
                </div>
                <div class="user-actions">
                    <a href="{{ url_for('profile') }}" class="profile-link">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="{{ url_for('notifications_page') }}" class="notifications-link">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</a>
                </div>
            </div>

            
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="center-column">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è -->
            <div class="action-card join-card">
                <div class="card-header">
                    <div class="card-icon">üö™</div>
                    <h3>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ</h3>
                </div>
                <form id="join-form" class="action-form">
                    <div class="input-group">
                        <input type="text" 
                               name="code" 
                               id="code" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã"
                               value="{{ code or '' }}"
                               class="modern-input">
                        <button type="submit" class="modern-btn primary-btn">
                            <span class="btn-text">–í–æ–π—Ç–∏</span>
                            <span class="btn-icon">‚Üí</span>
                        </button>
                    </div>
                </form>
                
            </div>
            
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
            <div class="action-card create-card">
                <div class="card-header">
                    <div class="card-icon">‚ú®</div>
                    <h3>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h3>
                </div>
                <form id="create-form" class="action-form">
                    <div class="input-group vertical">
                        <input type="text" 
                               name="title" 
                               id="title" 
                               placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                               class="modern-input">
                        
                        <label class="checkbox-modern">
                            <input type="checkbox" name="is_public" id="is_public">
                            <span class="checkmark"></span>
                            <span class="checkbox-text">–ü—É–±–ª–∏—á–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞</span>
                        </label>
                        
                        <button type="submit" class="modern-btn success-btn">
                            <span class="btn-text">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</span>
                            <span class="btn-icon">‚ûï</span>
                        </button>
                    </div>
                </form>

            </div>

                <!-- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ -->
            <div class="quick-search">
                <div class="search-header">
                    <h3>üîç –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫</h3>
                </div>
                <div class="search-container">
                    <input type="text" 
                           id="room-search" 
                           class="search-input" 
                           placeholder="–ù–∞–π—Ç–∏ –∫–æ–º–Ω–∞—Ç—ã..."
                           autocomplete="on">
                    <div id="search-results" class="search-results"></div>
                </div>
            </div>

            <div id="search-results-desktop" class="search-results desktop-only"></div>
        </div>

        
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –ø—É–±–ª–∏—á–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã -->
        <div class="right-column">
            <div class="rooms-card">
                <div class="card-header">
                    <div class="card-icon">üåê</div>
                    <h3>–†–µ–∫–ª–∞–º–∞</h3>
                </div>
                    <div class="loading-state">–ó–¥–µ—Å—å –º–æ–≥–ª–∞ –±—ã—Ç—å –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞ ;3</div>
                </div>
            </div>
        </div> 
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—à–∏–±–æ–∫ -->
<div id="error-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>–û—à–∏–±–∫–∞</h3>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <p id="error-message"></p>
        </div>
    </div>
</div>

<style>

/* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
@media (max-width: 768px) {
    .home-main {
        grid-template-columns: 1fr;
        gap: 15px;
        padding: 0 10px;
    }
    
    .left-column, .right-column {
        order: 2;
    }
    
    .center-column {
        order: 1;
    }
    
    .user-card {
        text-align: center;
        padding: 20px;
    }
    
    .user-avatar {
        width: 80px;
        height: 80px;
    }
    
    .action-card {
        padding: 20px;
    }
    
    .input-group {
        flex-direction: column;
    }
    
    .modern-btn {
        width: 100%;
        justify-content: center;
    }
    
    .rooms-card {
        position: static;
        margin-top: 20px;
    }
}

@media (max-width: 480px) {
    .home-container {
        padding: 10px 5px;
    }
    
    .action-card, .user-card, .quick-search {
        padding: 15px;
    }
    
    .card-header {
        flex-direction: column;
        gap: 10px;
        text-align: center;
    }
    
    .search-input {
        font-size: 16px; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑—É–º –≤ iOS */
    }
}



/* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
.home-container {
    min-height: 100vh;
    background: linear-gradient(135deg, #15202b 0%, #1c2d3d 100%);
    padding: 20px;
}

.home-header {
    margin-bottom: 30px;
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
}

.logo {
    font-size: 2.5em;
    font-weight: bold;
    background: linear-gradient(135deg, #19cf86, #1fd1a4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 0;
}

.user-stats {
    display: flex;
    gap: 30px;
}

.stat-item {
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 1.8em;
    font-weight: bold;
    color: #19cf86;
}

.stat-label {
    font-size: 0.9em;
    color: #8899a6;
}

.home-main {
    display: grid;
    grid-template-columns: 300px 1fr 350px;
    gap: 25px;
    max-width: 1400px;
    margin: 0 auto;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
.user-card {
    background: rgba(37, 51, 65, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid #38444d;
    border-radius: 20px;
    padding: 25px;
    margin-bottom: 25px;

    justify-content: center;
    align-items: center;
}

.user-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    margin-bottom: 15px;
    
}

.user-info h3 {
    margin: 0 0 5px 0;
    color: #d9d9d9;
    font-size: 1.2em;
}

.user-info p {
    margin: 0;
    color: #8899a6;
    font-size: 0.9em;
}

.user-actions {
    margin-top: 15px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.profile-link, .notifications-link {
    padding: 10px 15px;
    background: rgba(56, 68, 77, 0.6);
    color: #d9d9d9;
    text-decoration: none;
    border-radius: 12px;
    text-align: center;
    transition: all 0.3s ease;
    font-size: 0.9em;
}

.profile-link:hover, .notifications-link:hover {
    background: #38444d;
    transform: translateY(-2px);
}

/* –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ */
.quick-search {
    background: rgba(37, 51, 65, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid #38444d;
    border-radius: 20px;
    padding: 25px;  
}

.search-header h3 {
    margin: 0 0 15px 0;
    color: #d9d9d9;
    font-size: 1.1em;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
.action-card {
    background: rgba(37, 51, 65, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid #38444d;
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 25px;
}

.card-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 25px;
}

.card-icon {
    font-size: 1.5em;
}

.card-header h3 {
    margin: 0;
    color: #d9d9d9;
    font-size: 1.3em;
}

/* –§–æ—Ä–º—ã */
.action-form {
    width: 100%;
}

.input-group {
    display: flex;
    gap: 12px;
    align-items: flex-end;
}

.input-group.vertical {
    flex-direction: column;
    align-items: stretch;
    gap: 20px;
}

.modern-input {
    flex: 1;
    background: rgba(21, 32, 43, 0.6);
    border: 2px solid #38444d;
    border-radius: 15px;
    padding: 15px 20px;
    color: #d9d9d9;
    font-size: 1em;
    transition: all 0.3s ease;
}

.modern-input:focus {
    outline: none;
    border-color: #19cf86;
    background: rgba(21, 32, 43, 0.8);
}

/* –ö–Ω–æ–ø–∫–∏ */
.modern-btn {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 15px 25px;
    border: none;
    border-radius: 15px;
    font-size: 1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
}

.primary-btn {
    background: linear-gradient(135deg, #19cf86, #16b677);
    color: #15202b;
}

.success-btn {
    background: linear-gradient(135deg, #19cf86, #16b677);
    color: #15202b;
    width: 100%;
    justify-content: center;
}

.modern-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(25, 207, 134, 0.3);
}

/* –ß–µ–∫–±–æ–∫—Å */
.checkbox-modern {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    color: #d9d9d9;
    font-size: 1em;
}

.checkbox-modern input {
    display: none;
}

.checkmark {
    width: 22px;
    height: 22px;
    border: 2px solid #38444d;
    border-radius: 6px;
    position: relative;
    transition: all 0.3s ease;
}

.checkbox-modern input:checked + .checkmark {
    background: #19cf86;
    border-color: #19cf86;
}

.checkbox-modern input:checked + .checkmark::after {
    content: '‚úì';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #15202b;
    font-weight: bold;
    font-size: 14px;
}

/* –°–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç */
.rooms-card {
    background: rgba(37, 51, 65, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid #38444d;
    border-radius: 20px;
    padding: 30px;
    height: fit-content;
    position: sticky;
    top: 20px;
}

.rooms-card .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.refresh-btn {
    background: none;
    border: none;
    color: #3c4247ff;
    font-size: 1.2em;
    cursor: pointer;
    padding: 8px;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.refresh-btn:hover {
    background: #2d363dff;
    color: #d9d9d9;
    transform: rotate(180deg);
}

.rooms-list {
    max-height: 500px;
    overflow-y: auto;
}

.room-item {
    background: rgba(21, 32, 43, 0.6);
    border: 1px solid #38444d;
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 15px;
    transition: all 0.3s ease;
}

.room-item:hover {
    border-color: #19cf86;
    transform: translateY(-2px);
}

.room-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
}

.room-title {
    font-weight: bold;
    color: #d9d9d9;
    margin: 0;
    font-size: 1.1em;
}

.room-members {
    display: flex;
    align-items: center;
    gap: 5px;
    color: #19cf86;
    font-size: 0.9em;
    background: rgba(25, 207, 134, 0.1);
    padding: 4px 10px;
    border-radius: 12px;
}

.room-code {
    
}

.join-room-btn {
    width: 100%;
    background: rgba(25, 207, 134, 0.1);
    color: #19cf86;
    border: 1px solid rgba(25, 207, 134, 0.3);
    padding: 12px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
}

.join-room-btn:hover {
    background: #19cf86;
    color: #15202b;
    transform: translateY(-1px);
}

/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.modal-content {
    background: #253341;
    border-radius: 20px;
    border: 1px solid #38444d;
    width: 90%;
    max-width: 400px;
}

.modal-header {
    padding: 20px 25px;
    border-bottom: 1px solid #38444d;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    margin: 0;
    color: #d9d9d9;
}

.close-modal {
    background: none;
    border: none;
    color: #8899a6;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-body {
    padding: 25px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 1200px) {
    .home-main {
        grid-template-columns: 280px 1fr;
    }
    
    .right-column {
        grid-column: 1 / -1;
        margin-top: 20px;
    }
    
    .rooms-card {
        position: static;
    }
}

@media (max-width: 768px) {
    .home-container {
        padding: 15px;
    }
    
    .home-main {
        grid-template-columns: 100%;
        gap: 20px;
    }
    
    .header-content {
        flex-direction: column;
        text-align: center;
    }
    
    .user-stats {
        justify-content: center;
    }
    
    .left-column, .center-column, .right-column {
        width: 100%;
    }
    
    .input-group {
        flex-direction: column;
    }
    
    .modern-btn {
        width: 100%;
        justify-content: center;
    }
}

@media (max-width: 480px) {
    .home-container {
        padding: 10px;
    }
    
    .logo {
        font-size: 2em;
    }
    
    .action-card, .user-card, .quick-search, .rooms-card {
        padding: 20px;
    }
    
    .stat-number {
        font-size: 1.5em;
    }
}


/* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç */
.search-container {
    position: relative;
    z-index: 1000; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º z-index –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
}

.search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #253341;
    border: 1px solid #38444d;
    border-radius: 15px;
    margin-top: 10px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 10000; /* –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π z-index */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    display: none;
    
    /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    isolation: isolate;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
}

.search-results.active {
    display: block;
}

.search-result-item {
    padding: 15px 20px;
    border-bottom: 1px solid #38444d;
    cursor: pointer;
    transition: background-color 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    position: relative;
    z-index: 10001;
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background: #38444d;
}

/* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–º–µ—é—Ç –º–µ–Ω—å—à–∏–π z-index */
.action-card, .user-card, .quick-search, .rooms-card {
    position: relative;
    z-index: 1; /* –ù–∏–∑–∫–∏–π z-index –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
}

/* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */
@media (max-width: 768px) {
    .search-results {
        position: fixed; /* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —Ñ–∏–∫—Å–∏—Ä—É–µ–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ */
        top: auto;
        left: 10px;
        right: 10px;
        bottom: 10px;
        max-height: 50vh;
        z-index: 10000;
    }
    
    .search-container {
        z-index: 1000;
    }
}


/* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç */
.search-container {
    position: relative;
    z-index: 1000;
}

.search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #253341;
    border: 1px solid #38444d;
    border-radius: 15px;
    margin-top: 10px;
    max-height: 400px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –¥–ª—è –ü–ö */
    overflow-y: auto;
    z-index: 10000;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8); /* –ë–æ–ª–µ–µ —Ç–µ–º–Ω–∞—è —Ç–µ–Ω—å */
    display: none;
    
    /* –£–±–∏—Ä–∞–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ */
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

.search-results.active {
    display: block;
}

.search-result-item {
    padding: 15px 20px;
    border-bottom: 1px solid #38444d;
    cursor: pointer;
    transition: background-color 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* –ú–µ–Ω—è–µ–º –Ω–∞ flex-start –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ */
    gap: 15px;
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background: #38444d;
}

.search-result-content {
    flex: 1;
    min-width: 0; /* –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∂–∞—Ç–∏–µ */
    overflow: visible; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è */
}

.search-result-title {
    color: #d9d9d9;
    font-weight: bold;
    margin-bottom: 5px;
    
    /* –£–±–∏—Ä–∞–µ–º –æ–±—Ä–µ–∑–∫—É —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ü–ö */
    white-space: normal; /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫ */
    overflow: visible; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—ã—Ç–∏–µ */
    text-overflow: unset; /* –£–±–∏—Ä–∞–µ–º –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ */
    word-wrap: break-word; /* –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤ */
    line-height: 1.4; /* –£–ª—É—á—à–∞–µ–º —á–∏—Ç–∞–µ–º–æ—Å—Ç—å */
}

.search-result-meta {
    display: flex;
    gap: 15px;
    font-size: 0.85em;
    color: #8899a6;
    
    /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
    flex-wrap: wrap;
}

.search-result-code {
    font-family: 'Courier New', monospace;
    background: rgba(56, 68, 77, 0.5);
    padding: 2px 6px;
    border-radius: 4px;
}

.search-result-members {
    display: flex;
    align-items: center;
    gap: 4px;
}

.search-result-actions {
    flex-shrink: 0; /* –ù–µ –¥–∞–µ–º –∫–Ω–æ–ø–∫–µ —Å–∂–∏–º–∞—Ç—å—Å—è */
}

.join-search-result {
    background: rgba(25, 207, 134, 0.1);
    color: #19cf86;
    border: 1px solid rgba(25, 207, 134, 0.3);
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap; /* –¢–æ–ª—å–∫–æ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º nowrap */
}

.join-search-result:hover {
    background: #19cf86;
    color: #15202b;
}

/* Overlay –±–µ–∑ —Ä–∞–∑–º—ã—Ç–∏—è */
.search-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.1); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–µ–∑ —Ä–∞–∑–º—ã—Ç–∏—è */
    z-index: 9999;
    
    /* –£–±–∏—Ä–∞–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ */
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
@media (min-width: 769px) {
    .search-results {
        max-height: 500px; /* –ï—â–µ –±–æ–ª—å—à–µ –≤—ã—Å–æ—Ç–∞ –Ω–∞ –ü–ö */
    }
    
    .search-result-item {
        align-items: center; /* –ù–∞ –ü–ö –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–æ —Ü–µ–Ω—Ç—Ä—É */
    }
    
    .search-result-title {
        font-size: 1em;
        max-height: none; /* –£–±–∏—Ä–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã */
    }
}

/* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */
@media (max-width: 768px) {
    .search-results {
        position: fixed;
        top: auto;
        left: 10px;
        right: 10px;
        bottom: 10px;
        max-height: 60vh;
    }
    
    .search-result-item {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
    }
    
    .search-result-actions {
        align-self: flex-end;
    }
    
    .search-result-title {
        font-size: 1.1em;
    }
}

/* –û—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã */
@media (max-width: 480px) {
    .search-results {
        left: 5px;
        right: 5px;
        bottom: 5px;
        max-height: 70vh;
    }
    
    .search-result-item {
        padding: 12px 15px;
    }
    
    .search-result-meta {
        flex-direction: column;
        gap: 5px;
    }
}


/* –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è */
.join-search-result {
    background: rgba(25, 207, 134, 0.1);
    color: #19cf86;
    border: 1px solid rgba(25, 207, 134, 0.3);
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞ */
    position: relative;
    z-index: 1;
    pointer-events: auto;
}

.join-search-result:hover {
    background: #19cf86;
    color: #15202b;
}

/* –£–±–∏—Ä–∞–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ overlay */
.search-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.1);
    z-index: 9999;
    cursor: pointer;
    /* –£–±–∏—Ä–∞–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ */
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

/* –ù–∞ –ü–ö –¥–µ–ª–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≤ –ø–æ—Ç–æ–∫–µ –ø–æ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–æ–º–Ω–∞—Ç—ã */
@media (min-width: 769px) {
    .search-results {
        position: static !important; /* –£–±–∏—Ä–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ */
        max-height: none !important;
        margin-top: 20px;
        box-shadow: none;
        border: 1px solid #38444d;
        border-radius: 15px;
        display: none;
        width: 100%;
    }
    
    .search-results.active {
        display: block;
    }
    
    .search-container {
        position: static;
    }
    
    /* –°–∫—Ä—ã–≤–∞–µ–º overlay –Ω–∞ –ü–ö */
    .search-overlay {
        display: none !important;
    }
    
    /* –£–ª—É—á—à–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ü–ö */
    .search-result-item {
        padding: 15px 20px;
        border-bottom: 1px solid #38444d;
    }
    
    .search-result-item:last-child {
        border-bottom: none;
    }
    
    .search-result-title {
        white-space: normal;
        overflow: visible;
        text-overflow: unset;
        line-height: 1.4;
    }
}

/* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–≤–ª—è–µ–º overlay */
@media (max-width: 768px) {
    .search-results {
        position: fixed;
        top: auto;
        left: 10px;
        right: 10px;
        bottom: 10px;
        max-height: 60vh;
        z-index: 10000;
    }
    
    .search-overlay {
        display: block;
    }
}

/* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
.search-result-item,
.join-search-result {
    pointer-events: auto;
    cursor: pointer;
}

/* –£–±–∏—Ä–∞–µ–º –ª—é–±—ã–µ –∑–∞–ø—Ä–µ—Ç—ã —Å–æ–±—ã—Ç–∏–π */
.search-result-item * {
    pointer-events: auto;
}

</style>

<script>
class HomeManager {
    constructor() {
        this.searchOverlay = null;
        this.init();
    }

    init() {
        this.setupEventListeners();
        this.loadPublicRooms(); // –¢–µ–ø–µ—Ä—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        this.setupSearch();
    }

    setupEventListeners() {
        // –§–æ—Ä–º–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        const joinForm = document.getElementById('join-form');
        if (joinForm) {
            joinForm.addEventListener('submit', (e) => this.handleJoin(e));
        }

        // –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
        const createForm = document.getElementById('create-form');
        if (createForm) {
            createForm.addEventListener('submit', (e) => this.handleCreate(e));
        }

        // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–Ω–∞—Ç
        const refreshBtn = document.getElementById('refresh-rooms');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', () => this.loadPublicRooms());
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const closeModal = document.querySelector('.close-modal');
        if (closeModal) {
            closeModal.addEventListener('click', () => this.hideError());
        }
    }

    setupSearch() {
        const searchInput = document.getElementById('room-search');
        const resultsContainer = document.getElementById('search-results');
        const desktopResultsContainer = document.getElementById('search-results-desktop');
        
        if (!searchInput) return;

        let searchTimeout;

        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            const query = e.target.value.trim();
            
            if (query.length < 2) {
                this.hideResults();
                return;
            }

            searchTimeout = setTimeout(() => {
                this.searchRooms(query);
            }, 300);
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 768) {
                if (!searchInput.contains(e.target) && 
                    !resultsContainer.contains(e.target) &&
                    !this.searchOverlay?.contains(e.target)) {
                    this.hideResults();
                }
            }
        });
    }

    async searchRooms(query) {
        try {
            const response = await fetch(`/api/search-rooms?q=${encodeURIComponent(query)}`);
            const data = await response.json();
            this.displaySearchResults(data.rooms || []);
        } catch (error) {
            console.error('Search error:', error);
        }
    }

    displaySearchResults(rooms) {
    const mobileContainer = document.getElementById('search-results');
    const desktopContainer = document.getElementById('search-results-desktop');
    
    const renderResults = (container) => {
        if (!container) return;
        
        if (rooms.length === 0) {
            container.innerHTML = `
                <div class="search-result-item no-results">
                    <div style="text-align: center; color: #8899a6; padding: 20px;">
                        –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
                    </div>
                </div>
            `;
        } else {
            container.innerHTML = rooms.map(room => `
                <div class="search-result-item" data-code="${room.code}">
                    <div class="search-result-content">
                        <div class="search-result-title">${this.escapeHtml(room.title)}</div>
                        <div class="search-result-meta">
                            <span class="search-result-code">${room.code}</span>
                            <span class="search-result-members">üë• ${room.members}</span>
                        </div>
                    </div>
                    <button class="join-search-result" data-code="${room.code}">
                        –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è
                    </button>
                </div>
            `).join('');

            // –£–ë–ò–†–ê–ï–ú –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º –¢–û–õ–¨–ö–û –¥–ª—è –∫–Ω–æ–ø–∫–∏
            container.querySelectorAll('.join-search-result').forEach(joinButton => {
                const roomCode = joinButton.dataset.code;
                
                // –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
                joinButton.addEventListener('click', (e) => {
                    e.stopPropagation(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ
                    e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –¥–µ–π—Å—Ç–≤–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    this.selectRoom(roomCode);
                });
                
                // –ö–∞—Å–∞–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
                joinButton.addEventListener('touchstart', (e) => {
                    e.stopPropagation();
                    e.preventDefault();
                    this.selectRoom(roomCode);
                }, { passive: false });
            });
        }

        container.style.display = 'block';
        container.classList.add('active');
    };

    // –†–µ–Ω–¥–µ—Ä–∏–º –≤ –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    renderResults(mobileContainer);
    renderResults(desktopContainer);
    
    // –î–æ–±–∞–≤–ª—è–µ–º overlay —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
    if (window.innerWidth <= 768) {
        this.addSearchOverlay();
    }
}

    addSearchOverlay() {
        this.removeSearchOverlay();
        
        this.searchOverlay = document.createElement('div');
        this.searchOverlay.className = 'search-overlay';
        this.searchOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.1);
            z-index: 9999;
            cursor: pointer;
        `;
        
        document.body.appendChild(this.searchOverlay);
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ overlay
        this.searchOverlay.addEventListener('click', () => {
            this.hideResults();
        });
        
        this.searchOverlay.addEventListener('touchstart', (e) => {
            e.preventDefault();
            this.hideResults();
        }, { passive: false });
    }

    removeSearchOverlay() {
        if (this.searchOverlay) {
            this.searchOverlay.remove();
            this.searchOverlay = null;
        }
    }

    selectRoom(roomCode) {
        console.log('Selected room:', roomCode);
        
        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–æ–º–Ω–∞—Ç–∞
        fetch(`/api/check-room?code=${encodeURIComponent(roomCode)}`)
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    // –ö–æ–º–Ω–∞—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –≤—Ö–æ–¥–∏–º –≤ –Ω–µ–µ
                    window.location.href = `/room?room=${roomCode}`;
                } else {
                    // –ö–æ–º–Ω–∞—Ç–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                    this.showError('–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞');
                    this.hideResults();
                }
            })
            .catch(error => {
                console.error('Error checking room:', error);
                this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–º–Ω–∞—Ç—ã');
            });
        
        this.hideResults();
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
        const searchInput = document.getElementById('room-search');
        if (searchInput) {
            searchInput.value = '';
        }
    }

    hideResults() {
        const mobileContainer = document.getElementById('search-results');
        const desktopContainer = document.getElementById('search-results-desktop');
        
        if (mobileContainer) {
            mobileContainer.style.display = 'none';
            mobileContainer.classList.remove('active');
        }
        
        if (desktopContainer) {
            desktopContainer.style.display = 'none';
            desktopContainer.classList.remove('active');
        }
        
        this.removeSearchOverlay();
    }

    showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #e0245e;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 10000;
            font-weight: bold;
        `;
        errorDiv.textContent = message;
        document.body.appendChild(errorDiv);
        
        setTimeout(() => {
            if (document.body.contains(errorDiv)) {
                document.body.removeChild(errorDiv);
            }
        }, 3000);
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î loadPublicRooms
    async loadPublicRooms() {
        const container = document.getElementById('public-rooms');
        if (!container) return;

        container.innerHTML = '<div class="loading-state">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–Ω–∞—Ç...</div>';

        try {
            const response = await fetch('/api/public-rooms');
            const data = await response.json();
            this.renderPublicRooms(data.rooms || []);
        } catch (error) {
            console.error('Error loading public rooms:', error);
            container.innerHTML = '<div class="error-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–Ω–∞—Ç</div>';
        }
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î renderPublicRooms
    renderPublicRooms(rooms) {
    const container = document.getElementById('public-rooms');
    if (!container) return;

    if (!rooms.length) {
        container.innerHTML = '<div class="empty-state">–ü—É–±–ª–∏—á–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
        return;
    }

    container.innerHTML = rooms.map(room => `
        <div class="room-item">
            <div class="room-content">
                <h4 class="room-title">${this.escapeHtml(room.title)}</h4>
                <div class="room-meta">
                    <span class="room-code">${room.code}</span>
                    <span class="room-members">üë• ${room.members}</span>
                </div>
            </div>
            <button class="join-room-btn" data-code="${room.code}">
                –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è
            </button>
        </div>
    `).join('');

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¢–û–õ–¨–ö–û –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    container.querySelectorAll('.join-room-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            this.selectRoom(btn.dataset.code);
        });
        
        // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
        btn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            this.selectRoom(btn.dataset.code);
        }, { passive: false });
    });
}

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î handleJoin
    async handleJoin(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const code = formData.get('code').trim();

        if (!code) {
            this.showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã');
            return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
        try {
            const response = await fetch(`/api/check-room?code=${encodeURIComponent(code)}`);
            const data = await response.json();

            if (data.exists) {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –∫–æ–º–Ω–∞—Ç—É
                window.location.href = `/room?room=${code}`;
            } else {
                this.showError('–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É.');
            }
        } catch (error) {
            this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–º–Ω–∞—Ç—ã');
        }
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î handleCreate
    async handleCreate(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const title = formData.get('title').trim();
        const isPublic = formData.get('is_public') === 'on';

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
        try {
            const response = await fetch('/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    'create': 'create',
                    'title': title,
                    'is_public': isPublic
                })
            });

            if (response.ok) {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é –∫–æ–º–Ω–∞—Ç—É
                window.location.href = '/room';
            } else {
                this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–Ω–∞—Ç—ã');
            }
        } catch (error) {
            this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–Ω–∞—Ç—ã');
        }
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î hideError
    hideError() {
        const modal = document.getElementById('error-modal');
        if (modal) {
            modal.classList.add('hidden');
        }
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î escapeHtml
    escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    window.homeManager = new HomeManager();
    
    // –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(() => {
        if (window.homeManager && window.homeManager.loadPublicRooms) {
            window.homeManager.loadPublicRooms();
        }
    }, 30000);
});
</script>

<!-- –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ -->
<style>
.search-container {
    position: relative;
}


/* –£–±–∏—Ä–∞–µ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Å –∫–∞—Ä—Ç–æ—á–∫–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
.search-result-item {
    cursor: default; /* –û–±—ã—á–Ω—ã–π –∫—É—Ä—Å–æ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ */
    transition: background-color 0.3s ease;
}

/* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É - –Ω–µ –º–µ–Ω—è–µ–º —Ñ–æ–Ω (–∏–ª–∏ –º–µ–Ω—è–µ–º —Å–ª–∞–±–æ) */
.search-result-item:hover {
    background: rgba(56, 68, 77, 0.3); /* –õ–µ–≥–∫–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ */
}

/* –ö—É—Ä—Å–æ—Ä —É–∫–∞–∑–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
.join-search-result {
    cursor: pointer;
    background: rgba(25, 207, 134, 0.1);
    color: #19cf86;
    border: 1px solid rgba(25, 207, 134, 0.3);
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.join-search-result:hover {
    background: #19cf86;
    color: #15202b;
}

/* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –¥–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω–æ–π */
@media (max-width: 768px) {
    .join-search-result {
        padding: 10px 16px;
        font-size: 1em;
    }
    
    .search-result-item {
        padding: 16px 20px;
    }
}

.search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #253341;
    border: 1px solid #38444d;
    border-radius: 15px;
    margin-top: 10px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    display: none;
}

.search-result-item {
    padding: 15px 20px;
    border-bottom: 1px solid #38444d;
    cursor: pointer;
    transition: background-color 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background: #38444d;
}

.search-result-content {
    flex: 1;
    min-width: 0;
}

.search-result-title {
    color: #d9d9d9;
    font-weight: bold;
    margin-bottom: 5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-result-meta {
    display: flex;
    gap: 15px;
    font-size: 0.85em;
    color: #8899a6;
}

.search-result-code {
    font-family: 'Courier New', monospace;
}

.join-search-result {
    background: rgba(25, 207, 134, 0.1);
    color: #19cf86;
    border: 1px solid rgba(25, 207, 134, 0.3);
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.join-search-result:hover {
    background: #19cf86;
    color: #15202b;
}

.loading-state, .empty-state, .error-state {
    text-align: center;
    padding: 40px 20px;
    color: #8899a6;
    font-style: italic;
}
</style>
{% endblock %}